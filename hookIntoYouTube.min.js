/*!
 * Timed hooks into YouTube videos
 * @author Sahil Muthoo <sahil.muthoo@gmail.com> (https://sahilm.com)
 * @license MIT
 */
!function(window){"use strict";function onYouTubePlayerAPIReady(){youTubePlayerAPIReady=!0}function withYouTubePlayerAPI(onSuccess,onFailure,retries,delay){return youTubePlayerAPIReady?onSuccess():0>=retries?onFailure():(downloadYouTubePlayerAPI(),void setTimeout(function(){retries--,withYouTubePlayerAPI(onSuccess,onFailure,retries,delay)},delay))}function downloadYouTubePlayerAPI(){var tag=document.createElement("script");tag.src=youTubePlayerAPIHref;var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}function find(array,item){for(var i=0;i<array.length;i++)if(array[i]===item)return i;return-1}var ytHook={},youTubePlayerAPIReady=!1,youTubePlayerAPIHref="//www.youtube.com/iframe_api";ytHook.into=function(iframeId,hooks,startOnReady){function onSuccess(){function onPlayerReady(event){startOnReady&&event.target.playVideo()}function onPlayerStateChange(event){var poller,player=event.target;event.data!==YT.PlayerState.PLAYING||poller||(poller=callHooks(player)),(event.data===YT.PlayerState.ENDED||event.data===YT.PlayerState.PAUSED||event.data===YT.PlayerState.BUFFERING)&&clearTimeout(poller)}function callHooks(player){if(0!==hookTimes.length){var time=parseInt(player.getCurrentTime().toFixed(0),10),indexOfHook=find(hookTimes,time);return-1!==indexOfHook&&(setTimeout(function(){hooks.hook.call(hooks,time,player)},0),hookTimes.splice(indexOfHook,1)),setTimeout(function(){callHooks(player)},900)}}new YT.Player(iframeId,{events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})}function onFailure(){throw"Failed to load YouTube player API from "+youTubePlayerAPIHref}var hookTimes=hooks.atSeconds.sort(function(a,b){return a-b});withYouTubePlayerAPI(onSuccess,onFailure,2,200)},window.onYouTubePlayerAPIReady=onYouTubePlayerAPIReady,window.ytHook=ytHook}(window);